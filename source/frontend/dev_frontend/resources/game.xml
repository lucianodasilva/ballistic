<package>

  <effect name="square.effect">
    <vertex>
      <![CDATA[
      #version 330 core
      
      layout (location = 0) in vec3 in_position;
      layout (location = 1) in vec3 in_normal;
      
      uniform vec4        effect_diffuse;
      uniform vec4        effect_specular;
      uniform mat4        effect_t_model;
      uniform mat4        effect_t_view;
      uniform mat4        effect_t_proj;
      uniform mat4        effect_t_mvp;

      out vec4            var_color;

      void main () {

        var_color = vec4 (
          abs (in_normal.x),
          abs (in_normal.y),
          abs (in_normal.z),
        1.0);

        // test view + projection
        mat4 mvp = effect_t_proj * effect_t_view;
        vec4 pos = mvp * vec4 (in_position, 1.0);
        
        //vec3 light_pos = vec3 ( 2.0, 2.0, 2.0 );

        gl_Position = pos;
      }
      
      ]]>
    </vertex>
    <fragment>
      <![CDATA[
      #version 330 core

      in vec4 var_color;
      out vec4 out_color;
      
      void main () {
        out_color = var_color;
      }
      
      ]]>
    </fragment>
  </effect>

  <material name="square.material" diffuse="0.0, 1.0, 1.0, 1.0" opaque="true" effect="square.effect" />

  <mesh name="square.mesh">
    <!--     <position>
      0, 0.5, 0.0,
      0.5, -0.5, 0.0,
      -0.5, -0.5, 0.0
    </position> -->
    <position>
      0, .5, 0,
      -.5, -.5, -.5,
      .5, -.5, -.5,
      0, .5, 0,
      .5, -.5, -.5,
      .5, -.5, .5,
      0, .5, 0,
      .5, -.5, .5,
      -.5, -.5, .5,
      0, .5, 0,
      -.5, -.5, .5,
      -.5, -.5, -.5
    </position>
    <!--<uv>
      0.0, 0.0,
      1.0, 0.0,
      1.0, 1.0
    </uv>-->
    <normal>
      0, -.447, -.894,
      0, -.447, -.894,
      0, -.447, -.894,
      .894, -.447, 0,
      .894, -.447, 0,
      .894, -.447, 0,
      0, -.447, .894,
      0, -.447, .894,
      0, -.447, .894,
      -.894, -.447, 0,
      -.894, -.447, 0,
      -.894, -.447, 0
    </normal>
    <index>
      0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11
    </index>
  </mesh>

  <entity name="camera.entity">
    <properties>
      <position type="vec3" value="0, 0, 0"/>
      <target   type="vec3" value="0,0,0"/>
      <up       type="vec3" value="0, 1, 0"/>
    </properties>
    <components>
      <graphics_camera>

        <!--<projection value="ortho"/>
        <left   value="-5"/>
        <right  value="5"/>
        <top    value="5"/>
        <bottom value="-5"/>
        <near   value="-5"/>
        <far    value="10"/>-->

        
        <projection value="perspective"/>
        <fov   value="45"/>
        <near   value="0.1"/>
        <far    value="100"/>

      </graphics_camera>
      <orbit_cam/>
    </components>
  </entity>

  <entity name="rotating_square.entity">
    <properties>
      <position type="vec3" value="0, 0, 0"/>
      <material type="res"  value="square.material"/>
      <mesh     type="res"  value="square.mesh"/>
    </properties>
    <components>
      <graphics_visual/>
    </components>
  </entity>

</package>